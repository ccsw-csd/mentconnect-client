<p-toast key="questionnaireEmptyMessage" position="top-center"></p-toast>
<p-toast key="rolesEdited" position="top-center"></p-toast>
<p-toast key="questionnaireAssignDeleted" position="top-center"></p-toast>
<p-toast key="patientAssignOkMessage" position="top-center"></p-toast>
<p-blockUI [blocked]="isloading"></p-blockUI>
<div style="height: calc(10vh - 1rem);" class="col-lg-6 col-md-8 col-sm-12">
    <div class="flex flex-row-reverse flex-wrap card-container yellow-container mr-2">
      <div class="flex align-items-center justify-content-center font-bold text-gray-900">- {{patientObj.nif}}</div>
      <div class="flex align-items-center justify-content-center font-bold text-gray-900">:
        {{patientObj.user.name}} {{patientObj.user.surnames}}</div>
      <div class="flex align-items-center justify-content-center font-bold text-gray-900 m-2"
        [innerHTML]="'patientEvaluation.patientCard.patient' | translate"> </div>
      <div></div>
      <div class="flex align-items-center justify-content-center font-bold text-gray-900 m-2"><img alt="Card"
          src="assets/images/user.png" class="w-2rem h-2rem" /></div>
    </div>
  </div> 
    <div  class="justify-content-center align-items-center col-12 overflow-auto flex-grow-1 flex-shrink-1">
        <p-listbox name="role" [options]="roles" [(ngModel)]="rolesSelected" [metaKeySelection]="false" *ngIf="!isloading"
        [checkbox]="true" [multiple]="true" [showToggleAll]="false" optionLabel="roles" [listStyle]="{'height': 'calc(19vh - 1rem)','font-size':'11px'}">
        <p-header>{{ "patientEvaluation.roleList" | translate }}</p-header>
        <ng-template let-roles pTemplate="item">
            <div class="role-item">
                <div [pTooltip]=roles.code><span class="text-base">{{getTranslate(roles.code) |
                        translate}}</span></div>
                <div [pTooltip]=roles.code>{{getTranslateDetail(roles.code) | translate}}</div>
            </div>
        </ng-template>
    </p-listbox>
    </div>
    <div style="height: calc(5vh - 1rem)"  class="flex flex-row-reverse mt-5 ml-8 mb-2">
        <div class="px-2">
            <button type="button" pButton mat-raised-button class=" p-button-primary "
                (click)="changeRoles(rolesSelected)" label="{{ 'patientEvaluation.saveRoles' | translate}}"></button>
        </div>
    </div>
    <div style="height: calc(5vh - 1rem)">
        <label for="{{ 'patientEvaluation.questionnaires' | translate}}" class="ml-1">{{ 'patientEvaluation.questionnaires' | translate}}:</label>  
    </div>
    
    <div class="grid flex justify-content-center align-items-center">
        <div  class="col-12 md:col-5 lg:col-5">
            <p-listbox name="questionnaire" [(ngModel)]="questionnaireSelected" (onChange)="disabled()" *ngIf="!isloading"
            [options]="questionnairesAvailablesPatient" [metaKeySelection]="false" [checkbox]="true"
            [multiple]="false" [showToggleAll]="false" optionLabel="questionnairesAvailablesPatient"
            styleClass="w-full h-full" [listStyle]="{'height': 'calc(17vh - 1rem)','font-size':'11px'}" >
            <p-header>{{ "patientEvaluation.questionnaireAvailable" | translate }}</p-header>
            <ng-template let-questionnairesAvailablesPatient pTemplate="item">
                <div class="questionnairesAvailablesPatient-item">
                    <div [pTooltip]=questionnairesAvailablesPatient.description><span
                            class="text-base">{{questionnairesAvailablesPatient.description}}</span></div>
                    <div [pTooltip]=questionnairesAvailablesPatient.user_id>{{ 'patientEvaluation.questionsNumber' | translate}}:
                        {{questionnairesAvailablesPatient.questions.length}} | {{ 'patientEvaluation.responsibleUser' | translate}}:
                        {{questionnairesAvailablesPatient.user.name}}
                        {{questionnairesAvailablesPatient.user.surnames}}</div>
                </div>
            </ng-template>
        </p-listbox>
        </div>
        <div style="height: calc(25vh - 1rem)" class="col-12 md:col-2 lg:col-2 flex justify-content-center align-items-center mt-8">
            <div style="height: calc(25vh - 1rem)" class="field col"><br/><br/>
                <button pButton type="button" (click)="toAssign(questionnaireSelected)" icon="pi pi-angle-double-right"
                    class="p-button-lg p-button-text w-full " [disabled]="questionnaireDisabled"></button>
            </div>
        </div>
            <div class="col-12 md:col-5 lg:col-5">
            <p-listbox readonly [options]="questionnairesPatient" [metaKeySelection]="false" styleClass="w-full h-full" *ngIf="!isloading"
            [showToggleAll]="false" optionLabel="questionnairesPatient" [listStyle]="{'height': 'calc(17vh - 1rem)','font-size':'11px'}">
            <p-header>{{ "patientEvaluation.questionnaireAsign" | translate }}</p-header>
            <ng-template let-questionnairesPatient pTemplate="item">
                <button pButton type="button" (click)="deleteAssign(questionnairesPatient)" icon="pi pi-trash"
                    class="p-button-lg p-button-text "></button>
                <div class="questionnairePatient-item">
                    <div [pTooltip]=questionnairesPatient.description><span
                            class="text-base">{{questionnairesPatient.questionnaire.description}}</span>
                    </div>
                    <div>{{ "patientEvaluation.asignation" | translate }}:
                        {{questionnairesPatient.startDate}} - {{questionnairesPatient.endDate}}</div>
                </div>
            </ng-template>
            
        </p-listbox>
        </div>
    </div>
    
    <div style="height: calc(5vh - 1rem)" class="flex flex-row-reverse mt-2 ml-8 ">
        <div class="px-2 ">
            <button type="button" pButton mat-raised-button (click)="onCancel($event)"
                class="w-7rem p-button-secondary" label="{{ 'patientEdit.form.close' | translate}}"></button> 
        </div>
    </div>

