<p-toast key="questionnaireEmptyMessage" position="top-center"></p-toast>
<p-toast key="rolesEdited" position="top-center"></p-toast>
<p-toast key="questionnaireAssignDeleted" position="top-center"></p-toast>
<div class="col-12">
    <div class="card">
        <div class="flex flex-row-reverse flex-wrap card-container yellow-container">
            <div class="flex align-items-center justify-content-center font-bold text-gray-900">- {{patientObj.nif}}
            </div>
            <div class="flex align-items-center justify-content-center font-bold text-gray-900">:
                {{patientObj.user.name}} {{patientObj.user.surnames}}</div>
            <div class="flex align-items-center justify-content-center font-bold text-gray-900 m-2"
                [innerHTML]="'patientEvaluation.patientCard.patient' | translate"> </div>
            <div></div>
            <div class="flex align-items-center justify-content-center font-bold text-gray-900 m-2"><img alt="Card"
                    src="assets/images/user.png" class="w-2rem h-2rem" /></div>
        </div>
    </div>
</div>

<div class="col-12">
    <div class="field col">
        <span class="p-float-label">
            <p-listbox name="role" [options]="roles" [(ngModel)]="rolesSelected" [metaKeySelection]="false" [checkbox]="true" [multiple]="true"
                [showToggleAll]="false" optionLabel="roles" [listStyle]="{'height':'200px', 'font-size':'12px'}">
                <p-header>{{ "patientEvaluation.roleList" | translate }}</p-header>
                <ng-template let-roles pTemplate="item">
                    <div class="role-item">
                        <div [pTooltip]=roles.code><span class="text-base">{{getTranslate(roles.code) |
                                translate}}</span></div>
                        <div [pTooltip]=roles.code>{{getTranslateDetail(roles.code) | translate}}</div>
                    </div>
                </ng-template>
            </p-listbox>
        </span>
        <div class="flex flex align-items-end justify-content-end font-bold m-2 px-5 py-3 border-round">
            <button type="button" class="p-button-primary" pButton (click)="changeRoles(rolesSelected)">Aceptar</button>
        </div>
    </div>

</div>

<label for="cuestionarios">Cuestionarios:</label> <br />
<div class="flex">

    <div *ngIf="this.filteredQuestionnaires" class="flex-1 flex align-items-center justify-content-center font-bold m-2 px-5 py-3 border-round">
        <span class="p-float-label">
            <p-listbox name="questionnaire" [(ngModel)]="questionnaireSelected" (onChange)="disabled()" [options]="filteredQuestionnaires" [metaKeySelection]="false" [checkbox]="true" [multiple]="false"
                [showToggleAll]="false" optionLabel="filteredQuestionnaires" [listStyle]="{'width':'500px','height':'220px', 'font-size':'12px'}">
                <p-header>{{ "patientEvaluation.questionnaireAvailable" | translate }}</p-header>
                <ng-template let-filteredQuestionnaires pTemplate="item">
                    <div class="filteredQuestionnaires-item">
                        <div [pTooltip]=filteredQuestionnaires.description><span class="text-base">{{filteredQuestionnaires.description}}</span></div>
                        <div [pTooltip]=filteredQuestionnaires.user_id>Preguntas: {{filteredQuestionnaires.questionsNumber}} | Usuario responsable: {{filteredQuestionnaires.user.name}} {{filteredQuestionnaires.user.surnames}}</div>
                    </div>
                </ng-template>
            </p-listbox>
        </span>

    </div>
    <div class="flex-none flex align-items-center justify-content-center font-bold m-2 px-5 py-3 border-round">
        <button pButton type="button" (click)="toAssign(questionnaireSelected)" icon="pi pi-angle-double-right" class="p-button-lg p-button-text " [disabled]="questionnaireDisabled" ></button>
    </div>

    <div class="flex-1 flex align-items-center justify-content-center font-bold  m-2 px-5 py-3 border-round">
        <span class="p-float-label">
            <p-listbox readonly [options]="questionnairesPatient"   [metaKeySelection]="false"  styleClass="w-full"
                [showToggleAll]="false" optionLabel="questionnairesPatient" [listStyle]="{'width':'500px', 'height':'220px', 'font-size':'12px'}">
                <p-header>{{ "patientEvaluation.questionnaireAsign" | translate }}</p-header>
                <ng-template let-questionnairesPatient pTemplate="item">
                    <button pButton type="button" (click)="deleteAssign(questionnairesPatient)" icon="pi pi-trash" class="p-button-lg p-button-text " ></button>
                    <div class="questionnairePatient-item">
                        <div [pTooltip]=questionnairesPatient.description><span class="text-base">{{questionnairesPatient.questionnaire.description}}</span></div>
                        <div [pTooltip]=questionnairesPatient.user_id>Asignaci√≥n: {{questionnairesPatient.startDate}} - {{questionnairesPatient.endDate}}</div>
                    </div>
                </ng-template>
            </p-listbox>
        </span>
    </div>
</div>
<div class="flex flex-row-reverse  mt-5">
    <div class="px-2">
        <button type="button" pButton mat-raised-button (click)="onCancel($event)" class="w-7rem p-button-secondary"
            label="{{ 'patientEdit.form.close' | translate}}"></button>
    </div>
</div>